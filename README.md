# R4C - Robots for consumers

## Небольшая предыстория.
Давным-давно, в далёкой-далёкой галактике, была компания производящая различных 
роботов. 

Каждый робот(**Robot**) имел определенную модель выраженную двух-символьной 
последовательностью(например R2). Одновременно с этим, модель имела различные 
версии(например D2). Напоминает популярный телефон различных моделей(11,12,13...) и его версии
(X,XS,Pro...). Вне компании роботов чаще всего называли по серийному номеру, объединяя модель и версию(например R2-D2).

Также у компании были покупатели(**Customer**) которые периодически заказывали того или иного робота. 

Когда роботов не было в наличии - заказы покупателей(**Order**) попадали в список ожидания.

---
## Что делает данный код?
Это заготовка для сервиса, который ведет учет произведенных роботов,а также 
выполняет некие операции связанные с этим процессом.

Сервис нацелен на удовлетворение потребностей трёх категорий пользователей:
- Технические специалисты компании. Они будут присылать информацию
- Менеджмент компании. Они будут запрашивать информацию
- Клиенты. Им будут отправляться информация
___

## Как с этим работать?
- Создать для этого проекта репозиторий на GitHub
- Открыть данный проект в редакторе/среде разработки которую вы используете
- Ознакомиться с задачами в файле tasks.md
- Написать понятный и поддерживаемый код для каждой задачи 
- Сделать по 1 отдельному PR с решением для каждой задачи
- Прислать ссылку на своё решение

## Примечания от кандидата

## Запуск
Для запуска достаточно собрать и запустить docker контейнеры с нужными переменными окружения. Если контейнеры запущены локально, то можно перейти по http://127.0.0.1:8000

Для переменных окружения можно добавить файл .env в корень проекта согласно примеру из файла .env.example. 

Для того чтобы корректно работала отправка email-ов, необходимо настроить почту (подробнее для [яндекса](https://yandex.ru/support/yandex-360/customers/mail/ru/mail-clients/others)). TEST_EMAIL - это почта, куда будут отправляться письма при запуске тестов. Если не указать ее, письма будут отсылаться на EMAIL.

Для запуска контейнеров выполнить команду ```docker compose up --build```

Чтобы поверхностно посмотреть, что все работает, в проекте имеется коллекция postman. В ней находятся два запроса на создание робота и создание заказа. Это POST методы, чтобы не натолкнуться на CSRF, необходимо запускать контейнеры с переменной окружения DISABLE_CSRF=1, это позволит отключить django.middleware.csrf.CsrfViewMiddleware и проверку csrf токена.

Чтобы сгенерировать случайных роботов, выполнить команду ```python manage.py create_random_robots <кол-во роботов>```

Чтобы сгенерировать случайных заказчиков, выполнить команду ```python manage.py create_random_customers <кол-во заказчиков>```

Чтобы добавить заказчика с определенной почтой, выполнить команду ```python manage.py create_customer <email>```

## Эндпоинты

 - **POST robots/** - создание нового робота. Принимает json в формате ```{"model": "R2", "version": "D2","created":"2022-12-31 23:59:59"}```. Возвращает json в формате ```{"status": true, "message": "OK"}``` со статусом 201, если входные данные прошли валидацию. Возвращает json в формате ```{"status": false, "message": "errors..."}``` со статусом 400, если входные данные не прошли валидацию.
 - **GET robots/summary/** - скачать сводку по произведенным роботам за последнюю неделю в формате .xlsx.
 - **POST orders/** - создание нового заказа. Принимает json формате ```{"customer_id": 1, "robot_serial": "R2-D2"}```. Возвращает json в формате ```{"status": true, "message": "OK"}``` со статусом 201, если входные данные прошли валидацию и на складе есть товар. ```{"status": True, "message": "The product is out of stock"}``` со статусом 201, если входные данные прошли валидацию, но товара на складе нет. Возвращает json в формате ```{"status": false, "message": "errors..."}``` со статусом 400, если входные данные не прошли валидацию.

